{"ast":null,"code":"var _jsxFileName = \"/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { Switch, Route } from \"react-router-dom\";\nimport Login from \"./components/Login\";\nimport NavBar from \"./components/NavBar\";\nimport Products from \"./components/Products\";\nimport ProductDetails from \"./components/ProductDetails\";\nimport ShoppingPage from \"./components/ShoppingPage\";\nimport Footer from \"./components/Footer\";\nimport StorePage from \"./components/StorePage\";\nimport ShoppingCart from \"./components/ShoppingCart\";\nimport AccountPage from \"./components/AccountPage\";\nimport Checkout from \"./components/Checkout\";\nimport { useHistory } from \"react-router\";\nimport { useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [user, setUser] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [stores, setStores] = useState([]);\n  const [shoppingCart, setShoppingCart] = useState([]);\n  const [selectedStore, setSelectedStore] = useState(null);\n  const [fromMain, setFromMain] = useState(true);\n  const [selectedProduct, setSelectedProduct] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [search, setSearch] = useState('');\n  const [toDisplay, setToDisplay] = useState([]);\n  const [clothes, setClothes] = useState();\n  const [electronics, setElectronics] = useState([]);\n  const [tools, setTools] = useState([]);\n  const [health, setHealth] = useState([]);\n  const [music, setMusic] = useState([]);\n  const [all, setAll] = useState([]); // const [userCart, setUserCart] = useState([])\n\n  let history = useHistory();\n  const id = useParams().id;\n  useEffect(() => {\n    // auto-login\n    fetch(\"/me\").then(r => {\n      if (r.ok) {\n        r.json().then(user => setUser(user));\n      }\n    });\n  }, []);\n  useEffect(() => {\n    fetch(\"/stores\").then(r => {\n      if (r.ok) {\n        r.json().then(stores => setStores(stores));\n        setClothes(stores[0]);\n        console.log(clothes);\n        setElectronics(stores[1]);\n        setTools(stores[2]);\n        setHealth(stores[3]);\n        setMusic(stores[4]);\n        setAll(stores[5]);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    fetch(`/cart_items`).then(r => {\n      if (r.ok) {\n        r.json().then(cart => setShoppingCart(cart));\n      }\n    });\n    fetch(\"/products\").then(r => {\n      if (r.ok) {\n        r.json().then(products => setProducts(products)).then(history.push(\"/products\"));\n      }\n    });\n  }, []); // const clothes = stores[0]\n  // const electronics = stores[1]\n  // const tools = stores[2]\n  // const health = stores[3]\n  // const music = stores[4]\n  // const all = stores[5]\n\n  function toClothes() {\n    setSelectedStore(stores[0]);\n    history.push(`/stores/1`);\n  }\n\n  function toElectronics() {\n    setSelectedStore(stores[1]);\n    history.push(`/stores/2`);\n  }\n\n  function toTools() {\n    setSelectedStore(stores[2]);\n    history.push(`/stores/3`);\n  }\n\n  function toHealth() {\n    setSelectedStore(stores[3]);\n    history.push(`/stores/4`);\n  }\n\n  function toMusic() {\n    setSelectedStore(stores[4]);\n    history.push(`/stores/5`);\n  }\n\n  function toAll() {\n    setSelectedStore(stores[5]);\n    history.push(`/stores/6`);\n  }\n\n  function backBtn() {\n    {\n      // fromMain ? history.push(\"/shopping\") : \n      history.push(\"/products\");\n    }\n  }\n\n  const clearSearch = () => {\n    setToDisplay([]);\n  };\n\n  const handleSelect = product => {\n    setSelectedProduct(product); //  console.log(selectedProduct)\n  };\n\n  const handleChange = e => {\n    e.preventDefault();\n    setSearch(e.target.value); // console.log(search)\n  };\n\n  const searchProducts = products.filter(product => product.name.toLowerCase().includes(search.toLowerCase()));\n\n  const display = e => {\n    e.preventDefault();\n    setToDisplay(searchProducts); // console.log(toDisplay)    \n  };\n\n  const handleAddCart = (id, quantity, store) => {\n    let item = products.find(item => item.id === id);\n\n    if (shoppingCart.some(cart => cart.product.id === item.id)) {\n      let line = shoppingCart.find(cart => cart.product.id === item.id); // console.log(line);\n\n      return updateCartItemQuantity(line.id, quantity);\n    }\n\n    fetch(\"/cart_items\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        product_id: id,\n        quantity: quantity,\n        store_id: store.id\n      })\n    }).then(response => response.json()).then(item => setShoppingCart([...shoppingCart, item])).then(() => console.log(shoppingCart));\n  };\n\n  const updateCartItemQuantityFrontend = (id, quantity) => {\n    const updatedData = shoppingCart.map(item => {\n      if (item.id === id) {\n        return { ...item,\n          quantity: quantity\n        };\n      } else {\n        return item;\n      }\n    });\n    setShoppingCart(updatedData);\n  };\n\n  const updateCartItemQuantity = (CartItemID, quantity) => {\n    updateCartItemQuantityFrontend(CartItemID, quantity);\n    fetch(`/cart_items/${CartItemID}`, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        quantity: quantity\n      })\n    });\n  };\n\n  const removeFromCart = CartItemID => {\n    let updatedCart = shoppingCart.filter(item => item.id !== CartItemID);\n    setShoppingCart(updatedCart);\n    fetch(`/cart_items/${CartItemID}`, {\n      method: \"DELETE\"\n    });\n  };\n\n  if (!user) return /*#__PURE__*/_jsxDEV(Login, {\n    onLogin: setUser\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 205,\n    columnNumber: 21\n  }, this); // if (user) history.push(`/products`)\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(NavBar, {\n      user: user,\n      setUser: setUser,\n      search: search,\n      setSearch: setSearch,\n      handleChange: handleChange,\n      toDisplay: toDisplay,\n      setToDisplay: setToDisplay,\n      display: display,\n      searchProducts: searchProducts,\n      clearSearch: clearSearch,\n      cart: shoppingCart.length,\n      shoppingCart: shoppingCart // cart={userCartItems.length}\n\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      children: /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/shopping\",\n          children: /*#__PURE__*/_jsxDEV(ShoppingPage, {\n            stores: stores,\n            selectedStore: selectedStore,\n            setSelectedStore: setSelectedStore,\n            toClothes: toClothes,\n            toElectronics: toElectronics,\n            toTools: toTools,\n            toHealth: toHealth,\n            toMusic: toMusic,\n            toAll: toAll,\n            fromMain: fromMain,\n            setFromMain: setFromMain,\n            isLoading: isLoading,\n            clothes: clothes,\n            electronics: electronics,\n            tools: tools,\n            health: health,\n            music: music,\n            all: all\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/products/:id\",\n          children: /*#__PURE__*/_jsxDEV(ProductDetails, {\n            handleAddCart: handleAddCart,\n            products: products,\n            selectedProduct: selectedProduct,\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/products\",\n          children: /*#__PURE__*/_jsxDEV(Products, {\n            products: products,\n            stores: stores,\n            selectedStore: selectedStore,\n            setSelectedStore: setSelectedStore,\n            toClothes: toClothes,\n            toElectronics: toElectronics,\n            toTools: toTools,\n            toHealth: toHealth,\n            toMusic: toMusic,\n            toAll: toAll,\n            fromMain: fromMain,\n            setFromMain: setFromMain,\n            selectedProduct: selectedProduct,\n            setSelectedProduct: setSelectedProduct,\n            isLoading: isLoading,\n            clothes: clothes,\n            electronics: electronics,\n            tools: tools,\n            health: health,\n            music: music,\n            all: all,\n            handleSelect: handleSelect,\n            search: search,\n            setSearch: setSearch,\n            handleChange: handleChange,\n            toDisplay: toDisplay,\n            setToDisplay: setToDisplay,\n            display: display,\n            searchProducts: searchProducts,\n            clearSearch: clearSearch\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/stores/:id\",\n          children: /*#__PURE__*/_jsxDEV(StorePage, {\n            products: products,\n            selectedStore: selectedStore,\n            setSelectedStore: setSelectedStore,\n            fromMain: fromMain,\n            setFromMain: setFromMain,\n            backBtn: backBtn,\n            selectedProduct: selectedProduct,\n            setSelectedProduct: setSelectedProduct,\n            isLoading: isLoading,\n            clothes: clothes,\n            electronics: electronics,\n            tools: tools,\n            health: health,\n            music: music,\n            all: all\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: `/cart`,\n          children: /*#__PURE__*/_jsxDEV(ShoppingCart, {\n            shoppingCart: shoppingCart,\n            updateCartItemQuantity: updateCartItemQuantity,\n            removeFromCart: removeFromCart,\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/user\",\n          children: /*#__PURE__*/_jsxDEV(AccountPage, {\n            user: user,\n            setUser: setUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/checkout\",\n          children: /*#__PURE__*/_jsxDEV(Checkout, {\n            shoppingCart: shoppingCart,\n            setShoppingCart: setShoppingCart,\n            clothes: clothes,\n            electronics: electronics,\n            tools: tools,\n            health: health,\n            music: music,\n            all: all,\n            user: user,\n            removeFromCart: removeFromCart\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 210,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"RXwKx/BED7JVIv50I4PSn8zH9kY=\", false, function () {\n  return [useHistory, useParams];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/src/App.js"],"names":["React","useEffect","useState","Switch","Route","Login","NavBar","Products","ProductDetails","ShoppingPage","Footer","StorePage","ShoppingCart","AccountPage","Checkout","useHistory","useParams","App","user","setUser","products","setProducts","stores","setStores","shoppingCart","setShoppingCart","selectedStore","setSelectedStore","fromMain","setFromMain","selectedProduct","setSelectedProduct","isLoading","setIsLoading","search","setSearch","toDisplay","setToDisplay","clothes","setClothes","electronics","setElectronics","tools","setTools","health","setHealth","music","setMusic","all","setAll","history","id","fetch","then","r","ok","json","console","log","cart","push","toClothes","toElectronics","toTools","toHealth","toMusic","toAll","backBtn","clearSearch","handleSelect","product","handleChange","e","preventDefault","target","value","searchProducts","filter","name","toLowerCase","includes","display","handleAddCart","quantity","store","item","find","some","line","updateCartItemQuantity","method","headers","body","JSON","stringify","product_id","store_id","response","updateCartItemQuantityFrontend","updatedData","map","CartItemID","removeFromCart","updatedCart","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Switch, Route } from \"react-router-dom\";\nimport Login from \"./components/Login\";\nimport NavBar from \"./components/NavBar\";\nimport Products from \"./components/Products\";\nimport ProductDetails from \"./components/ProductDetails\";\nimport ShoppingPage from \"./components/ShoppingPage\";\nimport Footer from \"./components/Footer\";\nimport StorePage from \"./components/StorePage\";\nimport ShoppingCart from \"./components/ShoppingCart\";\nimport AccountPage from \"./components/AccountPage\";\nimport Checkout from \"./components/Checkout\";\nimport {useHistory} from \"react-router\";\nimport { useParams } from \"react-router-dom\";\n\n\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [stores, setStores] = useState([]);\n  const [shoppingCart, setShoppingCart] = useState([]);\n  const [selectedStore, setSelectedStore] = useState(null);\n  const [fromMain, setFromMain] = useState(true)\n  const [selectedProduct, setSelectedProduct] = useState(null)\n  const [isLoading, setIsLoading] = useState(false)\n  const [search, setSearch] = useState('')\n  const [toDisplay, setToDisplay] = useState([])\n  const [clothes, setClothes] = useState()\n  const [electronics, setElectronics] = useState([])\n  const [tools, setTools] = useState([])\n  const [health, setHealth] = useState([])\n  const [music, setMusic] = useState([])\n  const [all, setAll] = useState([])\n  // const [userCart, setUserCart] = useState([])\n\n  let history = useHistory();\n  const id = useParams().id;\n\n  useEffect(() => {\n    // auto-login\n    fetch(\"/me\").then((r) => {\n      if (r.ok) {\n        r.json().then((user) => setUser(user))\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(\"/stores\").then((r) => {\n      if (r.ok) {\n        r.json().then((stores) => setStores(stores));\n        setClothes(stores[0]);\n        console.log(clothes)\n        setElectronics(stores[1]);\n        setTools(stores[2]);\n        setHealth(stores[3]);\n        setMusic(stores[4]);\n        setAll(stores[5]);\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(`/cart_items`).then((r) => {\n      if (r.ok) {\n        r.json().then((cart) => setShoppingCart(cart));\n      }\n    });\n    fetch(\"/products\").then((r) => {\n      if (r.ok) {\n        r.json().then((products) => setProducts(products))\n        .then(history.push(\"/products\"))\n      }\n    });\n  }, []);\n\n// const clothes = stores[0]\n// const electronics = stores[1]\n// const tools = stores[2]\n// const health = stores[3]\n// const music = stores[4]\n// const all = stores[5]\n  \n\n  function toClothes(){\n    setSelectedStore(stores[0])\n    history.push(`/stores/1`)\n  }\n\n  function toElectronics(){\n    setSelectedStore(stores[1])\n    history.push(`/stores/2`)\n  }\n\n  function toTools(){\n    setSelectedStore(stores[2])\n    history.push(`/stores/3`)\n  }\n\n  function toHealth(){\n    setSelectedStore(stores[3])\n    history.push(`/stores/4`)\n  }\n\n  function toMusic(){\n    setSelectedStore(stores[4])\n    history.push(`/stores/5`)\n  }\n\n  function toAll(){\n    setSelectedStore(stores[5])\n    history.push(`/stores/6`)\n  }\n\n  function backBtn(){\n{\n  // fromMain ? history.push(\"/shopping\") : \n  history.push(\"/products\")}  \n}\n\nconst clearSearch = () => {\n  setToDisplay([])\n}\n\nconst handleSelect = (product) => {\n setSelectedProduct(product)\n//  console.log(selectedProduct)\n}\n\nconst handleChange = (e) => {\n  e.preventDefault()\n  setSearch(e.target.value)\n  // console.log(search)\n}\n\nconst searchProducts = products.filter(product => \n  product.name.toLowerCase().includes(search.toLowerCase())\n); \n\nconst display = (e) => {\n    e.preventDefault()\nsetToDisplay(searchProducts)\n// console.log(toDisplay)    \n}\n\nconst handleAddCart = (id, quantity, store) => {\n  let item = products.find((item) => item.id === id);\n\n  if (shoppingCart.some((cart) => cart.product.id === item.id)) {\n    let line = shoppingCart.find((cart) => cart.product.id === item.id);\n    // console.log(line);\n    return updateCartItemQuantity(line.id, quantity);\n  }\n\n  fetch(\"/cart_items\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      product_id: id,\n      quantity: quantity,\n      store_id: store.id\n    }),\n  })\n    .then((response) => response.json())\n    .then((item) => setShoppingCart([...shoppingCart, item]))\n    .then(() => console.log(shoppingCart))\n};\n\nconst updateCartItemQuantityFrontend = (id, quantity) => {\n  const updatedData = shoppingCart.map((item) => {\n    if (item.id === id) {\n      return {\n        ...item,\n        quantity: quantity,\n      };\n    } else {\n      return item;\n    }\n  });\n  setShoppingCart(updatedData);\n};\n\nconst updateCartItemQuantity = (CartItemID, quantity) => {\n  updateCartItemQuantityFrontend(CartItemID, quantity);\n  fetch(`/cart_items/${CartItemID}`, {\n    method: \"PATCH\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      quantity: quantity,\n    }),\n  });\n};\n\nconst removeFromCart = (CartItemID) => {\n  let updatedCart = shoppingCart.filter((item) => item.id !== CartItemID);\n  setShoppingCart(updatedCart);\n  fetch(`/cart_items/${CartItemID}`, {\n    method: \"DELETE\",\n  });\n};\n\n  if (!user) return <Login onLogin={setUser} />;\n  // if (user) history.push(`/products`)\n\n\n  return (\n    <div>\n      <NavBar \n        user={user} \n        setUser={setUser} \n        search={search} \n        setSearch={setSearch} \n        handleChange={handleChange}\n        toDisplay={toDisplay} \n        setToDisplay={setToDisplay} \n        display={display} \n        searchProducts={searchProducts} \n        clearSearch={clearSearch} \n        cart={shoppingCart.length}\n        shoppingCart={shoppingCart}\n        // cart={userCartItems.length}\n      />\n\n      <main>\n        <Switch>\n          <Route path=\"/shopping\">\n            <ShoppingPage \n              stores={stores} \n              selectedStore={selectedStore} \n              setSelectedStore={setSelectedStore}\n              toClothes={toClothes} \n              toElectronics={toElectronics} \n              toTools={toTools} \n              toHealth={toHealth} \n              toMusic={toMusic}\n              toAll={toAll}\n              fromMain={fromMain} \n              setFromMain={setFromMain}\n              isLoading={isLoading}\n              clothes={clothes}\n              electronics={electronics}\n              tools={tools}\n              health={health}\n              music={music}\n              all={all}\n            />\n          </Route>\n          <Route path=\"/products/:id\">\n            <ProductDetails \n              handleAddCart={handleAddCart} \n              products={products}\n              selectedProduct={selectedProduct}\n              user={user}\n            />\n          </Route>\n          <Route path=\"/products\">\n            <Products \n            products={products} \n            stores={stores} \n            selectedStore={selectedStore} \n            setSelectedStore={setSelectedStore} \n            toClothes={toClothes} \n            toElectronics={toElectronics} \n            toTools={toTools} \n            toHealth={toHealth} \n            toMusic={toMusic}\n            toAll={toAll}\n            fromMain={fromMain}\n            setFromMain={setFromMain}\n            selectedProduct={selectedProduct}\n            setSelectedProduct={setSelectedProduct}\n            isLoading={isLoading}\n            clothes={clothes}\n            electronics={electronics}\n            tools={tools}\n            health={health}\n            music={music}\n            all={all}\n            handleSelect={handleSelect}\n            search={search} \n            setSearch={setSearch} \n            handleChange={handleChange}\n            toDisplay={toDisplay} \n            setToDisplay={setToDisplay} \n            display={display} \n            searchProducts={searchProducts}\n            clearSearch={clearSearch}\n            />\n          </Route>\n          <Route path=\"/stores/:id\">\n            <StorePage \n              products={products} \n              selectedStore={selectedStore} \n              setSelectedStore={setSelectedStore} \n              fromMain={fromMain} \n              setFromMain={setFromMain} \n              backBtn={backBtn}    \n              selectedProduct={selectedProduct}\n              setSelectedProduct={setSelectedProduct}\n              isLoading={isLoading}\n              clothes={clothes}\n            electronics={electronics}\n            tools={tools}\n            health={health}\n            music={music}\n            all={all}\n            />\n          </Route>\n          <Route path={`/cart`}>\n            <ShoppingCart \n              shoppingCart={shoppingCart}\n              updateCartItemQuantity={updateCartItemQuantity}\n              removeFromCart={removeFromCart}\n              user={user}\n            />\n          </Route>\n          <Route path=\"/user\">\n            <AccountPage \n              user={user}\n              setUser={setUser}\n            />\n          </Route>\n          <Route path=\"/checkout\">\n            <Checkout\n              shoppingCart={shoppingCart}\n              setShoppingCart={setShoppingCart}\n              clothes={clothes}\n              electronics={electronics}\n              tools={tools}\n              health={health}\n              music={music}\n              all={all}\n              user={user}\n              removeFromCart={removeFromCart}\n            />\n          </Route>\n        </Switch>\n      </main>\n    <Footer />\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}