{"ast":null,"code":"import _objectSpread from\"/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Switch,Route,Redirect}from\"react-router-dom\";import Login from\"./components/Login\";import NavBar from\"./components/NavBar\";import Products from\"./components/Products\";import ProductDetails from\"./components/ProductDetails\";import ShoppingPage from\"./components/ShoppingPage\";import Footer from\"./components/Footer\";import StorePage from\"./components/StorePage\";import ShoppingCart from\"./components/ShoppingCart\";import AccountPage from\"./components/AccountPage\";import Checkout from\"./components/Checkout\";import{useHistory}from\"react-router\";import{useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),products=_useState4[0],setProducts=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),stores=_useState6[0],setStores=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),shoppingCart=_useState8[0],setShoppingCart=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),selectedStore=_useState10[0],setSelectedStore=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),fromMain=_useState12[0],setFromMain=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),selectedProduct=_useState14[0],setSelectedProduct=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isLoading=_useState16[0],setIsLoading=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),search=_useState18[0],setSearch=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),toDisplay=_useState20[0],setToDisplay=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),userCart=_useState22[0],setUserCart=_useState22[1];var history=useHistory();var id=useParams().id;useEffect(function(){// auto-login\nfetch(\"/me\").then(function(r){if(r.ok){r.json().then(function(user){return setUser(user);});}});},[]);useEffect(function(){fetch(\"/stores\").then(function(r){if(r.ok){r.json().then(function(stores){return setStores(stores);});}});},[]);useEffect(function(){fetch(\"/cart_items\").then(function(r){if(r.ok){r.json().then(function(cart){return setShoppingCart(cart);});}});fetch(\"/products\").then(function(r){if(r.ok){r.json().then(function(products){return setProducts(products);}).then(history.push(\"/products\"));}});},[]);// useEffect(() => {\n//   fetch(`/shopping_carts/${id}`)\n//     .then((res) => res.json())\n//     .then((data) => {\n//       setUserCart(data);\n//     });\n// }, [id]);\n// const userCartItems = shoppingCart.filter(item => \n//   item.shopping_cart.id === userCart.id)\nvar clothes=stores[0];var electronics=stores[1];var tools=stores[2];var health=stores[3];var music=stores[4];var all=stores[5];function toClothes(){setSelectedStore(stores[0]);history.push(\"/stores/1\");}function toElectronics(){setSelectedStore(stores[1]);history.push(\"/stores/2\");}function toTools(){setSelectedStore(stores[2]);history.push(\"/stores/3\");}function toHealth(){setSelectedStore(stores[3]);history.push(\"/stores/4\");}function toMusic(){setSelectedStore(stores[4]);history.push(\"/stores/5\");}function toAll(){setSelectedStore(stores[5]);history.push(\"/stores/6\");}function backBtn(){{// fromMain ? history.push(\"/shopping\") : \nhistory.push(\"/products\");}}var clearSearch=function clearSearch(){setToDisplay([]);};var handleSelect=function handleSelect(product){setSelectedProduct(product);//  console.log(selectedProduct)\n};var handleChange=function handleChange(e){e.preventDefault();setSearch(e.target.value);// console.log(search)\n};var searchProducts=products.filter(function(product){return product.name.toLowerCase().includes(search.toLowerCase());});var display=function display(e){e.preventDefault();setToDisplay(searchProducts);// console.log(toDisplay)    \n};var handleAddCart=function handleAddCart(id,quantity,store){var item=products.find(function(item){return item.id===id;});if(shoppingCart.some(function(cart){return cart.product.id===item.id;})){var line=shoppingCart.find(function(cart){return cart.product.id===item.id;});// console.log(line);\nreturn updateCartItemQuantity(line.id,quantity);}fetch(\"/cart_items\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({product_id:id,quantity:quantity,store_id:store.id})}).then(function(response){return response.json();}).then(function(item){return setShoppingCart([].concat(_toConsumableArray(shoppingCart),[item]));}).then(function(){return console.log(shoppingCart);});};var updateCartItemQuantityFrontend=function updateCartItemQuantityFrontend(id,quantity){var updatedData=shoppingCart.map(function(item){if(item.id===id){return _objectSpread(_objectSpread({},item),{},{quantity:quantity});}else{return item;}});setShoppingCart(updatedData);};var updateCartItemQuantity=function updateCartItemQuantity(CartItemID,quantity){updateCartItemQuantityFrontend(CartItemID,quantity);fetch(\"/cart_items/\".concat(CartItemID),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({quantity:quantity})});};var removeFromCart=function removeFromCart(CartItemID){var updatedCart=shoppingCart.filter(function(item){return item.id!==CartItemID;});setShoppingCart(updatedCart);fetch(\"/cart_items/\".concat(CartItemID),{method:\"DELETE\"});};if(!user)return/*#__PURE__*/_jsx(Login,{onLogin:setUser});// if (user) history.push(`/products`)\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(NavBar,{user:user,setUser:setUser,search:search,setSearch:setSearch,handleChange:handleChange,toDisplay:toDisplay,setToDisplay:setToDisplay,display:display,searchProducts:searchProducts,clearSearch:clearSearch,cart:shoppingCart.length,shoppingCart:shoppingCart// cart={userCartItems.length}\n}),/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{path:\"/shopping\",children:/*#__PURE__*/_jsx(ShoppingPage,{stores:stores,selectedStore:selectedStore,setSelectedStore:setSelectedStore,toClothes:toClothes,toElectronics:toElectronics,toTools:toTools,toHealth:toHealth,toMusic:toMusic,toAll:toAll,fromMain:fromMain,setFromMain:setFromMain,isLoading:isLoading,clothes:clothes,electronics:electronics,tools:tools,health:health,music:music,all:all})}),/*#__PURE__*/_jsx(Route,{path:\"/products/:id\",children:/*#__PURE__*/_jsx(ProductDetails,{handleAddCart:handleAddCart,products:products,selectedProduct:selectedProduct,user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/products\",children:/*#__PURE__*/_jsx(Products,{products:products,stores:stores,selectedStore:selectedStore,setSelectedStore:setSelectedStore,toClothes:toClothes,toElectronics:toElectronics,toTools:toTools,toHealth:toHealth,toMusic:toMusic,toAll:toAll,fromMain:fromMain,setFromMain:setFromMain,selectedProduct:selectedProduct,setSelectedProduct:setSelectedProduct,isLoading:isLoading,clothes:clothes,electronics:electronics,tools:tools,health:health,music:music,all:all,handleSelect:handleSelect,search:search,setSearch:setSearch,handleChange:handleChange,toDisplay:toDisplay,setToDisplay:setToDisplay,display:display,searchProducts:searchProducts,clearSearch:clearSearch})}),/*#__PURE__*/_jsx(Route,{path:\"/stores/:id\",children:/*#__PURE__*/_jsx(StorePage,{products:products,selectedStore:selectedStore,setSelectedStore:setSelectedStore,fromMain:fromMain,setFromMain:setFromMain,backBtn:backBtn,selectedProduct:selectedProduct,setSelectedProduct:setSelectedProduct,isLoading:isLoading,clothes:clothes,electronics:electronics,tools:tools,health:health,music:music,all:all})}),/*#__PURE__*/_jsx(Route,{path:\"/cart\",children:/*#__PURE__*/_jsx(ShoppingCart,{shoppingCart:shoppingCart,updateCartItemQuantity:updateCartItemQuantity,removeFromCart:removeFromCart,user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/user\",children:/*#__PURE__*/_jsx(AccountPage,{user:user,setUser:setUser})}),/*#__PURE__*/_jsx(Route,{path:\"/checkout\",children:/*#__PURE__*/_jsx(Checkout,{shoppingCart:shoppingCart,setShoppingCart:setShoppingCart,clothes:clothes,electronics:electronics,tools:tools,health:health,music:music,all:all,user:user,removeFromCart:removeFromCart})})]})}),/*#__PURE__*/_jsx(Footer,{})]});}export default App;","map":{"version":3,"sources":["/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/src/App.js"],"names":["React","useEffect","useState","Switch","Route","Redirect","Login","NavBar","Products","ProductDetails","ShoppingPage","Footer","StorePage","ShoppingCart","AccountPage","Checkout","useHistory","useParams","App","user","setUser","products","setProducts","stores","setStores","shoppingCart","setShoppingCart","selectedStore","setSelectedStore","fromMain","setFromMain","selectedProduct","setSelectedProduct","isLoading","setIsLoading","search","setSearch","toDisplay","setToDisplay","userCart","setUserCart","history","id","fetch","then","r","ok","json","cart","push","clothes","electronics","tools","health","music","all","toClothes","toElectronics","toTools","toHealth","toMusic","toAll","backBtn","clearSearch","handleSelect","product","handleChange","e","preventDefault","target","value","searchProducts","filter","name","toLowerCase","includes","display","handleAddCart","quantity","store","item","find","some","line","updateCartItemQuantity","method","headers","body","JSON","stringify","product_id","store_id","response","console","log","updateCartItemQuantityFrontend","updatedData","map","CartItemID","removeFromCart","updatedCart","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Switch, Route, Redirect} from \"react-router-dom\";\nimport Login from \"./components/Login\";\nimport NavBar from \"./components/NavBar\";\nimport Products from \"./components/Products\";\nimport ProductDetails from \"./components/ProductDetails\";\nimport ShoppingPage from \"./components/ShoppingPage\";\nimport Footer from \"./components/Footer\";\nimport StorePage from \"./components/StorePage\";\nimport ShoppingCart from \"./components/ShoppingCart\";\nimport AccountPage from \"./components/AccountPage\";\nimport Checkout from \"./components/Checkout\";\nimport {useHistory} from \"react-router\";\nimport { useParams } from \"react-router-dom\";\n\n\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [stores, setStores] = useState([]);\n  const [shoppingCart, setShoppingCart] = useState([]);\n  const [selectedStore, setSelectedStore] = useState(null);\n  const [fromMain, setFromMain] = useState(true)\n  const [selectedProduct, setSelectedProduct] = useState(null)\n  const [isLoading, setIsLoading] = useState(false)\n  const [search, setSearch] = useState('')\n  const [toDisplay, setToDisplay] = useState([])\n  const [userCart, setUserCart] = useState([])\n\n  let history = useHistory();\n  const id = useParams().id;\n\n  useEffect(() => {\n    // auto-login\n    fetch(\"/me\").then((r) => {\n      if (r.ok) {\n        r.json().then((user) => setUser(user))\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(\"/stores\").then((r) => {\n      if (r.ok) {\n        r.json().then((stores) => setStores(stores));\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(`/cart_items`).then((r) => {\n      if (r.ok) {\n        r.json().then((cart) => setShoppingCart(cart));\n      }\n    });\n    fetch(\"/products\").then((r) => {\n      if (r.ok) {\n        r.json().then((products) => setProducts(products))\n        .then(history.push(\"/products\"))\n      }\n    });\n  }, []);\n\n  // useEffect(() => {\n  //   fetch(`/shopping_carts/${id}`)\n  //     .then((res) => res.json())\n  //     .then((data) => {\n  //       setUserCart(data);\n  //     });\n  // }, [id]);\n\n  \n  // const userCartItems = shoppingCart.filter(item => \n  //   item.shopping_cart.id === userCart.id)\n\nconst clothes = stores[0]\nconst electronics = stores[1]\nconst tools = stores[2]\nconst health = stores[3]\nconst music = stores[4]\nconst all = stores[5]\n  \n\n  function toClothes(){\n    setSelectedStore(stores[0])\n    history.push(`/stores/1`)\n  }\n\n  function toElectronics(){\n    setSelectedStore(stores[1])\n    history.push(`/stores/2`)\n  }\n\n  function toTools(){\n    setSelectedStore(stores[2])\n    history.push(`/stores/3`)\n  }\n\n  function toHealth(){\n    setSelectedStore(stores[3])\n    history.push(`/stores/4`)\n  }\n\n  function toMusic(){\n    setSelectedStore(stores[4])\n    history.push(`/stores/5`)\n  }\n\n  function toAll(){\n    setSelectedStore(stores[5])\n    history.push(`/stores/6`)\n  }\n\n  function backBtn(){\n{\n  // fromMain ? history.push(\"/shopping\") : \n  history.push(\"/products\")}  \n}\n\nconst clearSearch = () => {\n  setToDisplay([])\n}\n\nconst handleSelect = (product) => {\n setSelectedProduct(product)\n//  console.log(selectedProduct)\n}\n\nconst handleChange = (e) => {\n  e.preventDefault()\n  setSearch(e.target.value)\n  // console.log(search)\n}\n\nconst searchProducts = products.filter(product => \n  product.name.toLowerCase().includes(search.toLowerCase())\n); \n\nconst display = (e) => {\n    e.preventDefault()\nsetToDisplay(searchProducts)\n// console.log(toDisplay)    \n}\n\nconst handleAddCart = (id, quantity, store) => {\n  let item = products.find((item) => item.id === id);\n\n  if (shoppingCart.some((cart) => cart.product.id === item.id)) {\n    let line = shoppingCart.find((cart) => cart.product.id === item.id);\n    // console.log(line);\n    return updateCartItemQuantity(line.id, quantity);\n  }\n\n  fetch(\"/cart_items\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      product_id: id,\n      quantity: quantity,\n      store_id: store.id\n    }),\n  })\n    .then((response) => response.json())\n    .then((item) => setShoppingCart([...shoppingCart, item]))\n    .then(() => console.log(shoppingCart))\n};\n\nconst updateCartItemQuantityFrontend = (id, quantity) => {\n  const updatedData = shoppingCart.map((item) => {\n    if (item.id === id) {\n      return {\n        ...item,\n        quantity: quantity,\n      };\n    } else {\n      return item;\n    }\n  });\n  setShoppingCart(updatedData);\n};\n\nconst updateCartItemQuantity = (CartItemID, quantity) => {\n  updateCartItemQuantityFrontend(CartItemID, quantity);\n  fetch(`/cart_items/${CartItemID}`, {\n    method: \"PATCH\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      quantity: quantity,\n    }),\n  });\n};\n\nconst removeFromCart = (CartItemID) => {\n  let updatedCart = shoppingCart.filter((item) => item.id !== CartItemID);\n  setShoppingCart(updatedCart);\n  fetch(`/cart_items/${CartItemID}`, {\n    method: \"DELETE\",\n  });\n};\n\n  if (!user) return <Login onLogin={setUser} />;\n  // if (user) history.push(`/products`)\n\n\n  return (\n    <div>\n      <NavBar \n        user={user} \n        setUser={setUser} \n        search={search} \n        setSearch={setSearch} \n        handleChange={handleChange}\n        toDisplay={toDisplay} \n        setToDisplay={setToDisplay} \n        display={display} \n        searchProducts={searchProducts} \n        clearSearch={clearSearch} \n        cart={shoppingCart.length}\n        shoppingCart={shoppingCart}\n        // cart={userCartItems.length}\n      />\n\n      <main>\n        <Switch>\n          <Route path=\"/shopping\">\n            <ShoppingPage \n              stores={stores} \n              selectedStore={selectedStore} \n              setSelectedStore={setSelectedStore}\n              toClothes={toClothes} \n              toElectronics={toElectronics} \n              toTools={toTools} \n              toHealth={toHealth} \n              toMusic={toMusic}\n              toAll={toAll}\n              fromMain={fromMain} \n              setFromMain={setFromMain}\n              isLoading={isLoading}\n              clothes={clothes}\n              electronics={electronics}\n              tools={tools}\n              health={health}\n              music={music}\n              all={all}\n            />\n          </Route>\n          <Route path=\"/products/:id\">\n            <ProductDetails \n              handleAddCart={handleAddCart} \n              products={products}\n              selectedProduct={selectedProduct}\n              user={user}\n            />\n          </Route>\n          <Route path=\"/products\">\n            <Products \n            products={products} \n            stores={stores} \n            selectedStore={selectedStore} \n            setSelectedStore={setSelectedStore} \n            toClothes={toClothes} \n            toElectronics={toElectronics} \n            toTools={toTools} \n            toHealth={toHealth} \n            toMusic={toMusic}\n            toAll={toAll}\n            fromMain={fromMain}\n            setFromMain={setFromMain}\n            selectedProduct={selectedProduct}\n            setSelectedProduct={setSelectedProduct}\n            isLoading={isLoading}\n            clothes={clothes}\n            electronics={electronics}\n            tools={tools}\n            health={health}\n            music={music}\n            all={all}\n            handleSelect={handleSelect}\n            search={search} \n            setSearch={setSearch} \n            handleChange={handleChange}\n            toDisplay={toDisplay} \n            setToDisplay={setToDisplay} \n            display={display} \n            searchProducts={searchProducts}\n            clearSearch={clearSearch}\n            />\n          </Route>\n          <Route path=\"/stores/:id\">\n            <StorePage \n              products={products} \n              selectedStore={selectedStore} \n              setSelectedStore={setSelectedStore} \n              fromMain={fromMain} \n              setFromMain={setFromMain} \n              backBtn={backBtn}    \n              selectedProduct={selectedProduct}\n              setSelectedProduct={setSelectedProduct}\n              isLoading={isLoading}\n              clothes={clothes}\n            electronics={electronics}\n            tools={tools}\n            health={health}\n            music={music}\n            all={all}\n            />\n          </Route>\n          <Route path={`/cart`}>\n            <ShoppingCart \n              shoppingCart={shoppingCart}\n              updateCartItemQuantity={updateCartItemQuantity}\n              removeFromCart={removeFromCart}\n              user={user}\n            />\n          </Route>\n          <Route path=\"/user\">\n            <AccountPage \n              user={user}\n              setUser={setUser}\n            />\n          </Route>\n          <Route path=\"/checkout\">\n            <Checkout\n              shoppingCart={shoppingCart}\n              setShoppingCart={setShoppingCart}\n              clothes={clothes}\n              electronics={electronics}\n              tools={tools}\n              health={health}\n              music={music}\n              all={all}\n              user={user}\n              removeFromCart={removeFromCart}\n            />\n          </Route>\n        </Switch>\n      </main>\n    <Footer />\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}