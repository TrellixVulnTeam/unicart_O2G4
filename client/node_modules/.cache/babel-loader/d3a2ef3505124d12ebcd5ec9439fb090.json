{"ast":null,"code":"var _jsxFileName = \"/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { Switch, Route } from \"react-router-dom\";\nimport Login from \"./components/Login\";\nimport NavBar from \"./components/NavBar\";\nimport Products from \"./components/Products\";\nimport ProductDetails from \"./components/ProductDetails\";\nimport ShoppingPage from \"./components/ShoppingPage\";\nimport Footer from \"./components/Footer\";\nimport StorePage from \"./components/StorePage\";\nimport ShoppingCart from \"./components/ShoppingCart\";\nimport AccountPage from \"./components/AccountPage\";\nimport Checkout from \"./components/Checkout\";\nimport { useHistory } from \"react-router\";\nimport { useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [user, setUser] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [stores, setStores] = useState([]);\n  const [shoppingCart, setShoppingCart] = useState([]);\n  const [selectedStore, setSelectedStore] = useState(null);\n  const [fromMain, setFromMain] = useState(true);\n  const [selectedProduct, setSelectedProduct] = useState(null); // const [isLoading, setIsLoading] = useState(false)\n\n  const [search, setSearch] = useState('');\n  const [toDisplay, setToDisplay] = useState([]);\n  const [userCart, setUserCart] = useState([]);\n  let history = useHistory();\n  const id = useParams().id;\n  useEffect(() => {\n    // auto-login\n    fetch(\"/me\").then(r => {\n      if (r.ok) {\n        r.json().then(user => setUser(user));\n      }\n    });\n  }, []);\n  useEffect(() => {\n    fetch(\"/stores\").then(r => {\n      if (r.ok) {\n        r.json().then(stores => setStores(stores));\n      }\n    });\n  }, []);\n  useEffect(() => {\n    fetch(`/cart_items`).then(r => {\n      if (r.ok) {\n        r.json().then(cart => setShoppingCart(cart));\n      }\n    });\n    fetch(\"/products\").then(r => {\n      if (r.ok) {\n        r.json().then(products => setProducts(products)).then(history.push(\"/products\"));\n      }\n    });\n  }, []);\n  const clothes = stores[0];\n  const electronics = stores[1];\n  const tools = stores[2];\n  const health = stores[3];\n  const music = stores[4];\n  const all = stores[5];\n\n  function toClothes() {\n    setSelectedStore(stores[0]);\n    history.push(`/stores/1`);\n  }\n\n  function toElectronics() {\n    setSelectedStore(stores[1]);\n    history.push(`/stores/2`);\n  }\n\n  function toTools() {\n    setSelectedStore(stores[2]);\n    history.push(`/stores/3`);\n  }\n\n  function toHealth() {\n    setSelectedStore(stores[3]);\n    history.push(`/stores/4`);\n  }\n\n  function toMusic() {\n    setSelectedStore(stores[4]);\n    history.push(`/stores/5`);\n  }\n\n  function toAll() {\n    setSelectedStore(stores[5]);\n    history.push(`/stores/6`);\n  }\n\n  function backBtn() {\n    {\n      // fromMain ? history.push(\"/shopping\") : \n      history.push(\"/products\");\n    }\n  }\n\n  const clearSearch = () => {\n    setToDisplay([]);\n  };\n\n  const handleSelect = product => {\n    setSelectedProduct(product); //  console.log(selectedProduct)\n  };\n\n  const handleChange = e => {\n    e.preventDefault();\n    setSearch(e.target.value); // console.log(search)\n  };\n\n  const searchProducts = products.filter(product => product.name.toLowerCase().includes(search.toLowerCase()));\n\n  const display = e => {\n    e.preventDefault();\n    setToDisplay(searchProducts); // console.log(toDisplay)    \n  };\n\n  const handleAddCart = (id, quantity, store) => {\n    let item = products.find(item => item.id === id);\n\n    if (shoppingCart.some(cart => cart.product.id === item.id)) {\n      let line = shoppingCart.find(cart => cart.product.id === item.id); // console.log(line);\n\n      return updateCartItemQuantity(line.id, quantity);\n    }\n\n    fetch(\"/cart_items\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        product_id: id,\n        quantity: quantity,\n        store_id: store.id\n      })\n    }).then(response => response.json()).then(item => setShoppingCart([...shoppingCart, item])).then(() => console.log(shoppingCart));\n  };\n\n  const updateCartItemQuantityFrontend = (id, quantity) => {\n    const updatedData = shoppingCart.map(item => {\n      if (item.id === id) {\n        return { ...item,\n          quantity: quantity\n        };\n      } else {\n        return item;\n      }\n    });\n    setShoppingCart(updatedData);\n  };\n\n  const updateCartItemQuantity = (CartItemID, quantity) => {\n    updateCartItemQuantityFrontend(CartItemID, quantity);\n    fetch(`/cart_items/${CartItemID}`, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        quantity: quantity\n      })\n    });\n  };\n\n  const removeFromCart = CartItemID => {\n    let updatedCart = shoppingCart.filter(item => item.id !== CartItemID);\n    setShoppingCart(updatedCart);\n    fetch(`/cart_items/${CartItemID}`, {\n      method: \"DELETE\"\n    });\n  };\n\n  if (!user) return /*#__PURE__*/_jsxDEV(Login, {\n    onLogin: setUser\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 192,\n    columnNumber: 21\n  }, this); // if (user) history.push(`/products`)\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(NavBar, {\n      user: user,\n      setUser: setUser,\n      search: search,\n      setSearch: setSearch,\n      handleChange: handleChange,\n      toDisplay: toDisplay,\n      setToDisplay: setToDisplay,\n      display: display,\n      searchProducts: searchProducts,\n      clearSearch: clearSearch,\n      cart: shoppingCart.length,\n      shoppingCart: shoppingCart // cart={userCartItems.length}\n\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      children: /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/shopping\",\n          children: /*#__PURE__*/_jsxDEV(ShoppingPage, {\n            stores: stores,\n            selectedStore: selectedStore,\n            setSelectedStore: setSelectedStore,\n            toClothes: toClothes,\n            toElectronics: toElectronics,\n            toTools: toTools,\n            toHealth: toHealth,\n            toMusic: toMusic,\n            toAll: toAll,\n            fromMain: fromMain,\n            setFromMain: setFromMain,\n            isLoading: isLoading,\n            clothes: clothes,\n            electronics: electronics,\n            tools: tools,\n            health: health,\n            music: music,\n            all: all\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/products/:id\",\n          children: /*#__PURE__*/_jsxDEV(ProductDetails, {\n            handleAddCart: handleAddCart,\n            products: products,\n            selectedProduct: selectedProduct,\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/products\",\n          children: /*#__PURE__*/_jsxDEV(Products, {\n            products: products,\n            stores: stores,\n            selectedStore: selectedStore,\n            setSelectedStore: setSelectedStore,\n            toClothes: toClothes,\n            toElectronics: toElectronics,\n            toTools: toTools,\n            toHealth: toHealth,\n            toMusic: toMusic,\n            toAll: toAll,\n            fromMain: fromMain,\n            setFromMain: setFromMain,\n            selectedProduct: selectedProduct,\n            setSelectedProduct: setSelectedProduct,\n            isLoading: isLoading,\n            clothes: clothes,\n            electronics: electronics,\n            tools: tools,\n            health: health,\n            music: music,\n            all: all,\n            handleSelect: handleSelect,\n            search: search,\n            setSearch: setSearch,\n            handleChange: handleChange,\n            toDisplay: toDisplay,\n            setToDisplay: setToDisplay,\n            display: display,\n            searchProducts: searchProducts,\n            clearSearch: clearSearch\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/stores/:id\",\n          children: /*#__PURE__*/_jsxDEV(StorePage, {\n            products: products,\n            selectedStore: selectedStore,\n            setSelectedStore: setSelectedStore,\n            fromMain: fromMain,\n            setFromMain: setFromMain,\n            backBtn: backBtn,\n            selectedProduct: selectedProduct,\n            setSelectedProduct: setSelectedProduct,\n            isLoading: isLoading,\n            clothes: clothes,\n            electronics: electronics,\n            tools: tools,\n            health: health,\n            music: music,\n            all: all\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: `/cart`,\n          children: /*#__PURE__*/_jsxDEV(ShoppingCart, {\n            shoppingCart: shoppingCart,\n            updateCartItemQuantity: updateCartItemQuantity,\n            removeFromCart: removeFromCart,\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/user\",\n          children: /*#__PURE__*/_jsxDEV(AccountPage, {\n            user: user,\n            setUser: setUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/checkout\",\n          children: /*#__PURE__*/_jsxDEV(Checkout, {\n            shoppingCart: shoppingCart,\n            setShoppingCart: setShoppingCart,\n            clothes: clothes,\n            electronics: electronics,\n            tools: tools,\n            health: health,\n            music: music,\n            all: all,\n            user: user,\n            removeFromCart: removeFromCart\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 197,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"ZrPQU8Pm8kUbjbkowQM9OAp4dUE=\", false, function () {\n  return [useHistory, useParams];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/src/App.js"],"names":["React","useEffect","useState","Switch","Route","Login","NavBar","Products","ProductDetails","ShoppingPage","Footer","StorePage","ShoppingCart","AccountPage","Checkout","useHistory","useParams","App","user","setUser","products","setProducts","stores","setStores","shoppingCart","setShoppingCart","selectedStore","setSelectedStore","fromMain","setFromMain","selectedProduct","setSelectedProduct","search","setSearch","toDisplay","setToDisplay","userCart","setUserCart","history","id","fetch","then","r","ok","json","cart","push","clothes","electronics","tools","health","music","all","toClothes","toElectronics","toTools","toHealth","toMusic","toAll","backBtn","clearSearch","handleSelect","product","handleChange","e","preventDefault","target","value","searchProducts","filter","name","toLowerCase","includes","display","handleAddCart","quantity","store","item","find","some","line","updateCartItemQuantity","method","headers","body","JSON","stringify","product_id","store_id","response","console","log","updateCartItemQuantityFrontend","updatedData","map","CartItemID","removeFromCart","updatedCart","length","isLoading"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Switch, Route } from \"react-router-dom\";\nimport Login from \"./components/Login\";\nimport NavBar from \"./components/NavBar\";\nimport Products from \"./components/Products\";\nimport ProductDetails from \"./components/ProductDetails\";\nimport ShoppingPage from \"./components/ShoppingPage\";\nimport Footer from \"./components/Footer\";\nimport StorePage from \"./components/StorePage\";\nimport ShoppingCart from \"./components/ShoppingCart\";\nimport AccountPage from \"./components/AccountPage\";\nimport Checkout from \"./components/Checkout\";\nimport {useHistory} from \"react-router\";\nimport { useParams } from \"react-router-dom\";\n\n\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [stores, setStores] = useState([]);\n  const [shoppingCart, setShoppingCart] = useState([]);\n  const [selectedStore, setSelectedStore] = useState(null);\n  const [fromMain, setFromMain] = useState(true)\n  const [selectedProduct, setSelectedProduct] = useState(null)\n  // const [isLoading, setIsLoading] = useState(false)\n  const [search, setSearch] = useState('')\n  const [toDisplay, setToDisplay] = useState([])\n  const [userCart, setUserCart] = useState([])\n\n  let history = useHistory();\n  const id = useParams().id;\n\n  useEffect(() => {\n    // auto-login\n    fetch(\"/me\").then((r) => {\n      if (r.ok) {\n        r.json().then((user) => setUser(user))\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(\"/stores\").then((r) => {\n      if (r.ok) {\n        r.json().then((stores) => setStores(stores));\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(`/cart_items`).then((r) => {\n      if (r.ok) {\n        r.json().then((cart) => setShoppingCart(cart));\n      }\n    });\n    fetch(\"/products\").then((r) => {\n      if (r.ok) {\n        r.json().then((products) => setProducts(products))\n        .then(history.push(\"/products\"))\n      }\n    });\n  }, []);\n\nconst clothes = stores[0]\nconst electronics = stores[1]\nconst tools = stores[2]\nconst health = stores[3]\nconst music = stores[4]\nconst all = stores[5]\n  \n\n  function toClothes(){\n    setSelectedStore(stores[0])\n    history.push(`/stores/1`)\n  }\n\n  function toElectronics(){\n    setSelectedStore(stores[1])\n    history.push(`/stores/2`)\n  }\n\n  function toTools(){\n    setSelectedStore(stores[2])\n    history.push(`/stores/3`)\n  }\n\n  function toHealth(){\n    setSelectedStore(stores[3])\n    history.push(`/stores/4`)\n  }\n\n  function toMusic(){\n    setSelectedStore(stores[4])\n    history.push(`/stores/5`)\n  }\n\n  function toAll(){\n    setSelectedStore(stores[5])\n    history.push(`/stores/6`)\n  }\n\n  function backBtn(){\n{\n  // fromMain ? history.push(\"/shopping\") : \n  history.push(\"/products\")}  \n}\n\nconst clearSearch = () => {\n  setToDisplay([])\n}\n\nconst handleSelect = (product) => {\n setSelectedProduct(product)\n//  console.log(selectedProduct)\n}\n\nconst handleChange = (e) => {\n  e.preventDefault()\n  setSearch(e.target.value)\n  // console.log(search)\n}\n\nconst searchProducts = products.filter(product => \n  product.name.toLowerCase().includes(search.toLowerCase())\n); \n\nconst display = (e) => {\n    e.preventDefault()\nsetToDisplay(searchProducts)\n// console.log(toDisplay)    \n}\n\nconst handleAddCart = (id, quantity, store) => {\n  let item = products.find((item) => item.id === id);\n\n  if (shoppingCart.some((cart) => cart.product.id === item.id)) {\n    let line = shoppingCart.find((cart) => cart.product.id === item.id);\n    // console.log(line);\n    return updateCartItemQuantity(line.id, quantity);\n  }\n\n  fetch(\"/cart_items\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      product_id: id,\n      quantity: quantity,\n      store_id: store.id\n    }),\n  })\n    .then((response) => response.json())\n    .then((item) => setShoppingCart([...shoppingCart, item]))\n    .then(() => console.log(shoppingCart))\n};\n\nconst updateCartItemQuantityFrontend = (id, quantity) => {\n  const updatedData = shoppingCart.map((item) => {\n    if (item.id === id) {\n      return {\n        ...item,\n        quantity: quantity,\n      };\n    } else {\n      return item;\n    }\n  });\n  setShoppingCart(updatedData);\n};\n\nconst updateCartItemQuantity = (CartItemID, quantity) => {\n  updateCartItemQuantityFrontend(CartItemID, quantity);\n  fetch(`/cart_items/${CartItemID}`, {\n    method: \"PATCH\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      quantity: quantity,\n    }),\n  });\n};\n\nconst removeFromCart = (CartItemID) => {\n  let updatedCart = shoppingCart.filter((item) => item.id !== CartItemID);\n  setShoppingCart(updatedCart);\n  fetch(`/cart_items/${CartItemID}`, {\n    method: \"DELETE\",\n  });\n};\n\n  if (!user) return <Login onLogin={setUser} />;\n  // if (user) history.push(`/products`)\n\n\n  return (\n    <div>\n      <NavBar \n        user={user} \n        setUser={setUser} \n        search={search} \n        setSearch={setSearch} \n        handleChange={handleChange}\n        toDisplay={toDisplay} \n        setToDisplay={setToDisplay} \n        display={display} \n        searchProducts={searchProducts} \n        clearSearch={clearSearch} \n        cart={shoppingCart.length}\n        shoppingCart={shoppingCart}\n        // cart={userCartItems.length}\n      />\n\n      <main>\n        <Switch>\n          <Route path=\"/shopping\">\n            <ShoppingPage \n              stores={stores} \n              selectedStore={selectedStore} \n              setSelectedStore={setSelectedStore}\n              toClothes={toClothes} \n              toElectronics={toElectronics} \n              toTools={toTools} \n              toHealth={toHealth} \n              toMusic={toMusic}\n              toAll={toAll}\n              fromMain={fromMain} \n              setFromMain={setFromMain}\n              isLoading={isLoading}\n              clothes={clothes}\n              electronics={electronics}\n              tools={tools}\n              health={health}\n              music={music}\n              all={all}\n            />\n          </Route>\n          <Route path=\"/products/:id\">\n            <ProductDetails \n              handleAddCart={handleAddCart} \n              products={products}\n              selectedProduct={selectedProduct}\n              user={user}\n            />\n          </Route>\n          <Route path=\"/products\">\n            <Products \n            products={products} \n            stores={stores} \n            selectedStore={selectedStore} \n            setSelectedStore={setSelectedStore} \n            toClothes={toClothes} \n            toElectronics={toElectronics} \n            toTools={toTools} \n            toHealth={toHealth} \n            toMusic={toMusic}\n            toAll={toAll}\n            fromMain={fromMain}\n            setFromMain={setFromMain}\n            selectedProduct={selectedProduct}\n            setSelectedProduct={setSelectedProduct}\n            isLoading={isLoading}\n            clothes={clothes}\n            electronics={electronics}\n            tools={tools}\n            health={health}\n            music={music}\n            all={all}\n            handleSelect={handleSelect}\n            search={search} \n            setSearch={setSearch} \n            handleChange={handleChange}\n            toDisplay={toDisplay} \n            setToDisplay={setToDisplay} \n            display={display} \n            searchProducts={searchProducts}\n            clearSearch={clearSearch}\n            />\n          </Route>\n          <Route path=\"/stores/:id\">\n            <StorePage \n              products={products} \n              selectedStore={selectedStore} \n              setSelectedStore={setSelectedStore} \n              fromMain={fromMain} \n              setFromMain={setFromMain} \n              backBtn={backBtn}    \n              selectedProduct={selectedProduct}\n              setSelectedProduct={setSelectedProduct}\n              isLoading={isLoading}\n              clothes={clothes}\n            electronics={electronics}\n            tools={tools}\n            health={health}\n            music={music}\n            all={all}\n            />\n          </Route>\n          <Route path={`/cart`}>\n            <ShoppingCart \n              shoppingCart={shoppingCart}\n              updateCartItemQuantity={updateCartItemQuantity}\n              removeFromCart={removeFromCart}\n              user={user}\n            />\n          </Route>\n          <Route path=\"/user\">\n            <AccountPage \n              user={user}\n              setUser={setUser}\n            />\n          </Route>\n          <Route path=\"/checkout\">\n            <Checkout\n              shoppingCart={shoppingCart}\n              setShoppingCart={setShoppingCart}\n              clothes={clothes}\n              electronics={electronics}\n              tools={tools}\n              health={health}\n              music={music}\n              all={all}\n              user={user}\n              removeFromCart={removeFromCart}\n            />\n          </Route>\n        </Switch>\n      </main>\n    <Footer />\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}