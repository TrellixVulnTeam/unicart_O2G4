{"ast":null,"code":"var _jsxFileName = \"/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { Switch, Route } from \"react-router-dom\";\nimport Login from \"./components/Login\";\nimport NavBar from \"./components/NavBar\";\nimport Products from \"./components/Products\";\nimport ProductDetails from \"./components/ProductDetails\";\nimport ShoppingPage from \"./components/ShoppingPage\";\nimport Footer from \"./components/Footer\";\nimport StorePage from \"./components/StorePage\";\nimport ShoppingCart from \"./components/ShoppingCart\";\nimport AccountPage from \"./components/AccountPage\";\nimport Checkout from \"./components/Checkout\";\nimport { useHistory } from \"react-router\";\nimport { useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [user, setUser] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [stores, setStores] = useState([]);\n  const [shoppingCart, setShoppingCart] = useState([]);\n  const [selectedStore, setSelectedStore] = useState(null);\n  const [fromMain, setFromMain] = useState(true);\n  const [selectedProduct, setSelectedProduct] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [search, setSearch] = useState('');\n  const [toDisplay, setToDisplay] = useState([]); // const [clothes, setClothes] = useState([])\n  // const [electronics, setElectronics] = useState([])\n  // const [tools, setTools] = useState([])\n  // const [health, setHealth] = useState([])\n  // const [music, setMusic] = useState([])\n  // const [all, setAll] = useState([])\n\n  let history = useHistory();\n  const id = useParams().id;\n  useEffect(() => {\n    // auto-login\n    fetch(\"/me\").then(r => {\n      if (r.ok) {\n        r.json().then(user => setUser(user));\n      }\n    });\n  }, []);\n  useEffect(() => {\n    fetch(\"/stores\").then(r => {\n      if (r.ok) {\n        r.json().then(stores => setStores(stores)); // .then(setClothes(stores[0]))\n        // .then(console.log(clothes))\n        // setElectronics(stores[1]);\n        // setTools(stores[2]);\n        // setHealth(stores[3]);\n        // setMusic(stores[4]);\n        // setAll(stores[5]);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    fetch(`/cart_items`).then(r => {\n      if (r.ok) {\n        r.json().then(cart => setShoppingCart(cart));\n      }\n    });\n    fetch(\"/products\").then(r => {\n      if (r.ok) {\n        r.json().then(products => setProducts(products)).then(history.push(\"/productspage\"));\n      }\n    });\n  }, []);\n  const clothes = stores[0];\n  const electronics = stores[1];\n  const tools = stores[2];\n  const health = stores[3];\n  const music = stores[4];\n  const all = stores[5];\n\n  function toClothes() {\n    setSelectedStore(stores[0]);\n    history.push(`/storespage/1`);\n  }\n\n  function toElectronics() {\n    setSelectedStore(stores[1]);\n    history.push(`/storespage/2`);\n  }\n\n  function toTools() {\n    setSelectedStore(stores[2]);\n    history.push(`/storespage/3`);\n  }\n\n  function toHealth() {\n    setSelectedStore(stores[3]);\n    history.push(`/storespage/4`);\n  }\n\n  function toMusic() {\n    setSelectedStore(stores[4]);\n    history.push(`/storespage/5`);\n  }\n\n  function toAll() {\n    setSelectedStore(stores[5]);\n    history.push(`/storespage/6`);\n  }\n\n  function backBtn() {\n    {\n      // fromMain ? history.push(\"/shopping\") : \n      history.push(\"/productspage\");\n    }\n  }\n\n  const clearSearch = () => {\n    setToDisplay([]);\n  };\n\n  const handleSelect = product => {\n    setSelectedProduct(product); //  console.log(selectedProduct)\n  };\n\n  const handleChange = e => {\n    e.preventDefault();\n    setSearch(e.target.value); // console.log(search)\n  };\n\n  const searchProducts = products.filter(product => product.name.toLowerCase().includes(search.toLowerCase()));\n\n  const display = e => {\n    e.preventDefault();\n    setToDisplay(searchProducts); // console.log(toDisplay)    \n  };\n\n  const handleAddCart = (id, quantity, store) => {\n    let item = products.find(item => item.id === id);\n\n    if (shoppingCart.some(cart => cart.product.id === item.id)) {\n      let line = shoppingCart.find(cart => cart.product.id === item.id); // console.log(line);\n\n      return updateCartItemQuantity(line.id, quantity);\n    }\n\n    fetch(\"/cart_items\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        product_id: id,\n        quantity: quantity,\n        store_id: store.id\n      })\n    }).then(response => response.json()).then(item => setShoppingCart([...shoppingCart, item])).then(() => console.log(shoppingCart));\n  };\n\n  const updateCartItemQuantityFrontend = (id, quantity) => {\n    const updatedData = shoppingCart.map(item => {\n      if (item.id === id) {\n        return { ...item,\n          quantity: quantity\n        };\n      } else {\n        return item;\n      }\n    });\n    setShoppingCart(updatedData);\n  };\n\n  const updateCartItemQuantity = (CartItemID, quantity) => {\n    updateCartItemQuantityFrontend(CartItemID, quantity);\n    fetch(`/cart_items/${CartItemID}`, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        quantity: quantity\n      })\n    });\n  };\n\n  const removeFromCart = CartItemID => {\n    let updatedCart = shoppingCart.filter(item => item.id !== CartItemID);\n    setShoppingCart(updatedCart);\n    fetch(`/cart_items/${CartItemID}`, {\n      method: \"DELETE\"\n    });\n  };\n\n  if (!user) return /*#__PURE__*/_jsxDEV(Login, {\n    onLogin: setUser\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 204,\n    columnNumber: 21\n  }, this); // if (user) history.push(`/products`)\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Router, {\n      children: [/*#__PURE__*/_jsxDEV(NavBar, {\n        user: user,\n        setUser: setUser,\n        search: search,\n        setSearch: setSearch,\n        handleChange: handleChange,\n        toDisplay: toDisplay,\n        setToDisplay: setToDisplay,\n        display: display,\n        searchProducts: searchProducts,\n        clearSearch: clearSearch,\n        cart: shoppingCart.length,\n        shoppingCart: shoppingCart // cart={userCartItems.length}\n\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        children: /*#__PURE__*/_jsxDEV(Routes, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            path: \"/productspage/:id\",\n            element: /*#__PURE__*/_jsxDEV(ProductDetails, {\n              handleAddCart: handleAddCart,\n              products: products,\n              selectedProduct: selectedProduct,\n              user: user\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/productspage\",\n            element: /*#__PURE__*/_jsxDEV(Products, {\n              products: products,\n              stores: stores,\n              selectedStore: selectedStore,\n              setSelectedStore: setSelectedStore,\n              toClothes: toClothes,\n              toElectronics: toElectronics,\n              toTools: toTools,\n              toHealth: toHealth,\n              toMusic: toMusic,\n              toAll: toAll,\n              fromMain: fromMain,\n              setFromMain: setFromMain,\n              selectedProduct: selectedProduct,\n              setSelectedProduct: setSelectedProduct,\n              isLoading: isLoading,\n              clothes: clothes,\n              electronics: electronics,\n              tools: tools,\n              health: health,\n              music: music,\n              all: all,\n              handleSelect: handleSelect,\n              search: search,\n              setSearch: setSearch,\n              handleChange: handleChange,\n              toDisplay: toDisplay,\n              setToDisplay: setToDisplay,\n              display: display,\n              searchProducts: searchProducts,\n              clearSearch: clearSearch\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/storespage/:id\",\n            element: /*#__PURE__*/_jsxDEV(StorePage, {\n              products: products,\n              selectedStore: selectedStore,\n              setSelectedStore: setSelectedStore,\n              fromMain: fromMain,\n              setFromMain: setFromMain,\n              backBtn: backBtn,\n              selectedProduct: selectedProduct,\n              setSelectedProduct: setSelectedProduct,\n              isLoading: isLoading,\n              clothes: clothes,\n              electronics: electronics,\n              tools: tools,\n              health: health,\n              music: music,\n              all: all\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: `/cartpage`,\n            element: /*#__PURE__*/_jsxDEV(ShoppingCart, {\n              shoppingCart: shoppingCart,\n              updateCartItemQuantity: updateCartItemQuantity,\n              removeFromCart: removeFromCart,\n              user: user\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/userpage\",\n            element: /*#__PURE__*/_jsxDEV(AccountPage, {\n              user: user,\n              setUser: setUser\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/checkoutpage\",\n            element: /*#__PURE__*/_jsxDEV(Checkout, {\n              shoppingCart: shoppingCart,\n              setShoppingCart: setShoppingCart,\n              clothes: clothes,\n              electronics: electronics,\n              tools: tools,\n              health: health,\n              music: music,\n              all: all,\n              user: user,\n              removeFromCart: removeFromCart\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 209,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"aasYFMpOyYfa3qD8Y37jYeUG/l0=\", false, function () {\n  return [useHistory, useParams];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/noamlubofsky/Flatiron/Code/phase5/final-project/unicart/client/src/App.js"],"names":["React","useEffect","useState","Switch","Route","Login","NavBar","Products","ProductDetails","ShoppingPage","Footer","StorePage","ShoppingCart","AccountPage","Checkout","useHistory","useParams","App","user","setUser","products","setProducts","stores","setStores","shoppingCart","setShoppingCart","selectedStore","setSelectedStore","fromMain","setFromMain","selectedProduct","setSelectedProduct","isLoading","setIsLoading","search","setSearch","toDisplay","setToDisplay","history","id","fetch","then","r","ok","json","cart","push","clothes","electronics","tools","health","music","all","toClothes","toElectronics","toTools","toHealth","toMusic","toAll","backBtn","clearSearch","handleSelect","product","handleChange","e","preventDefault","target","value","searchProducts","filter","name","toLowerCase","includes","display","handleAddCart","quantity","store","item","find","some","line","updateCartItemQuantity","method","headers","body","JSON","stringify","product_id","store_id","response","console","log","updateCartItemQuantityFrontend","updatedData","map","CartItemID","removeFromCart","updatedCart","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Switch, Route } from \"react-router-dom\";\nimport Login from \"./components/Login\";\nimport NavBar from \"./components/NavBar\";\nimport Products from \"./components/Products\";\nimport ProductDetails from \"./components/ProductDetails\";\nimport ShoppingPage from \"./components/ShoppingPage\";\nimport Footer from \"./components/Footer\";\nimport StorePage from \"./components/StorePage\";\nimport ShoppingCart from \"./components/ShoppingCart\";\nimport AccountPage from \"./components/AccountPage\";\nimport Checkout from \"./components/Checkout\";\nimport {useHistory} from \"react-router\";\nimport { useParams } from \"react-router-dom\";\n\n\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [stores, setStores] = useState([]);\n  const [shoppingCart, setShoppingCart] = useState([]);\n  const [selectedStore, setSelectedStore] = useState(null);\n  const [fromMain, setFromMain] = useState(true)\n  const [selectedProduct, setSelectedProduct] = useState(null)\n  const [isLoading, setIsLoading] = useState(false)\n  const [search, setSearch] = useState('')\n  const [toDisplay, setToDisplay] = useState([])\n  // const [clothes, setClothes] = useState([])\n  // const [electronics, setElectronics] = useState([])\n  // const [tools, setTools] = useState([])\n  // const [health, setHealth] = useState([])\n  // const [music, setMusic] = useState([])\n  // const [all, setAll] = useState([])\n\n  let history = useHistory();\n  const id = useParams().id;\n\n  useEffect(() => {\n    // auto-login\n    fetch(\"/me\").then((r) => {\n      if (r.ok) {\n        r.json().then((user) => setUser(user))\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(\"/stores\").then((r) => {\n      if (r.ok) {\n        r.json().then((stores) => setStores(stores))\n        // .then(setClothes(stores[0]))\n        // .then(console.log(clothes))\n        // setElectronics(stores[1]);\n        // setTools(stores[2]);\n        // setHealth(stores[3]);\n        // setMusic(stores[4]);\n        // setAll(stores[5]);\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(`/cart_items`).then((r) => {\n      if (r.ok) {\n        r.json().then((cart) => setShoppingCart(cart));\n      }\n    });\n    fetch(\"/products\").then((r) => {\n      if (r.ok) {\n        r.json().then((products) => setProducts(products))\n        .then(history.push(\"/productspage\"))\n      }\n    });\n  }, []);\n\nconst clothes = stores[0]\nconst electronics = stores[1]\nconst tools = stores[2]\nconst health = stores[3]\nconst music = stores[4]\nconst all = stores[5]\n  \n\n  function toClothes(){\n    setSelectedStore(stores[0])\n    history.push(`/storespage/1`)\n  }\n\n  function toElectronics(){\n    setSelectedStore(stores[1])\n    history.push(`/storespage/2`)\n  }\n\n  function toTools(){\n    setSelectedStore(stores[2])\n    history.push(`/storespage/3`)\n  }\n\n  function toHealth(){\n    setSelectedStore(stores[3])\n    history.push(`/storespage/4`)\n  }\n\n  function toMusic(){\n    setSelectedStore(stores[4])\n    history.push(`/storespage/5`)\n  }\n\n  function toAll(){\n    setSelectedStore(stores[5])\n    history.push(`/storespage/6`)\n  }\n\n  function backBtn(){\n{\n  // fromMain ? history.push(\"/shopping\") : \n  history.push(\"/productspage\")}  \n}\n\nconst clearSearch = () => {\n  setToDisplay([])\n}\n\nconst handleSelect = (product) => {\n setSelectedProduct(product)\n//  console.log(selectedProduct)\n}\n\nconst handleChange = (e) => {\n  e.preventDefault()\n  setSearch(e.target.value)\n  // console.log(search)\n}\n\nconst searchProducts = products.filter(product => \n  product.name.toLowerCase().includes(search.toLowerCase())\n); \n\nconst display = (e) => {\n    e.preventDefault()\nsetToDisplay(searchProducts)\n// console.log(toDisplay)    \n}\n\nconst handleAddCart = (id, quantity, store) => {\n  let item = products.find((item) => item.id === id);\n\n  if (shoppingCart.some((cart) => cart.product.id === item.id)) {\n    let line = shoppingCart.find((cart) => cart.product.id === item.id);\n    // console.log(line);\n    return updateCartItemQuantity(line.id, quantity);\n  }\n\n  fetch(\"/cart_items\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      product_id: id,\n      quantity: quantity,\n      store_id: store.id\n    }),\n  })\n    .then((response) => response.json())\n    .then((item) => setShoppingCart([...shoppingCart, item]))\n    .then(() => console.log(shoppingCart))\n};\n\nconst updateCartItemQuantityFrontend = (id, quantity) => {\n  const updatedData = shoppingCart.map((item) => {\n    if (item.id === id) {\n      return {\n        ...item,\n        quantity: quantity,\n      };\n    } else {\n      return item;\n    }\n  });\n  setShoppingCart(updatedData);\n};\n\nconst updateCartItemQuantity = (CartItemID, quantity) => {\n  updateCartItemQuantityFrontend(CartItemID, quantity);\n  fetch(`/cart_items/${CartItemID}`, {\n    method: \"PATCH\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      quantity: quantity,\n    }),\n  });\n};\n\nconst removeFromCart = (CartItemID) => {\n  let updatedCart = shoppingCart.filter((item) => item.id !== CartItemID);\n  setShoppingCart(updatedCart);\n  fetch(`/cart_items/${CartItemID}`, {\n    method: \"DELETE\",\n  });\n};\n\n  if (!user) return <Login onLogin={setUser} />;\n  // if (user) history.push(`/products`)\n\n\n  return (\n    <div>\n      <Router>\n      <NavBar \n        user={user} \n        setUser={setUser} \n        search={search} \n        setSearch={setSearch} \n        handleChange={handleChange}\n        toDisplay={toDisplay} \n        setToDisplay={setToDisplay} \n        display={display} \n        searchProducts={searchProducts} \n        clearSearch={clearSearch} \n        cart={shoppingCart.length}\n        shoppingCart={shoppingCart}\n        // cart={userCartItems.length}\n      />\n\n      <main>\n        <Routes>\n\n          <Route path=\"/productspage/:id\" element={\n            <ProductDetails \n              handleAddCart={handleAddCart} \n              products={products}\n              selectedProduct={selectedProduct}\n              user={user}\n            />}/>\n          \n          <Route path=\"/productspage\" element={\n            <Products \n            products={products} \n            stores={stores} \n            selectedStore={selectedStore} \n            setSelectedStore={setSelectedStore} \n            toClothes={toClothes} \n            toElectronics={toElectronics} \n            toTools={toTools} \n            toHealth={toHealth} \n            toMusic={toMusic}\n            toAll={toAll}\n            fromMain={fromMain}\n            setFromMain={setFromMain}\n            selectedProduct={selectedProduct}\n            setSelectedProduct={setSelectedProduct}\n            isLoading={isLoading}\n            clothes={clothes}\n            electronics={electronics}\n            tools={tools}\n            health={health}\n            music={music}\n            all={all}\n            handleSelect={handleSelect}\n            search={search} \n            setSearch={setSearch} \n            handleChange={handleChange}\n            toDisplay={toDisplay} \n            setToDisplay={setToDisplay} \n            display={display} \n            searchProducts={searchProducts}\n            clearSearch={clearSearch}\n            />}/>\n          <Route path=\"/storespage/:id\" element={\n            <StorePage \n              products={products} \n              selectedStore={selectedStore} \n              setSelectedStore={setSelectedStore} \n              fromMain={fromMain} \n              setFromMain={setFromMain} \n              backBtn={backBtn}    \n              selectedProduct={selectedProduct}\n              setSelectedProduct={setSelectedProduct}\n              isLoading={isLoading}\n              clothes={clothes}\n            electronics={electronics}\n            tools={tools}\n            health={health}\n            music={music}\n            all={all}\n            />}/>\n          <Route path={`/cartpage`} element={\n            <ShoppingCart \n              shoppingCart={shoppingCart}\n              updateCartItemQuantity={updateCartItemQuantity}\n              removeFromCart={removeFromCart}\n              user={user}\n              />}/>\n          <Route path=\"/userpage\" element={\n            <AccountPage \n              user={user}\n              setUser={setUser}\n              />}/>\n          <Route path=\"/checkoutpage\" element={\n            <Checkout\n              shoppingCart={shoppingCart}\n              setShoppingCart={setShoppingCart}\n              clothes={clothes}\n              electronics={electronics}\n              tools={tools}\n              health={health}\n              music={music}\n              all={all}\n              user={user}\n              removeFromCart={removeFromCart}\n              />}/>\n        </Routes>\n      </main>\n    <Footer />\n    </Router>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}